-- INI-Datei
-- Remake von Gravity Force Level 4
-- von Frapela
-- 11.08.2003

player[1]:load_image(LEVEL_DIR .. "./frapela/piranha.bmp")
player[1]:set_lifes(4)

player[1]:set_wall_shield(0)
player[1]:set_wall_shield_recharge(0)
player[1]:set_shield(2)
player[1]:set_max_shield(2)
player[1]:set_shield_recharge(0.01)
player[1]:set_hull(1)
player[1]:set_max_hull(1)
player[1]:set_hull_repair(0)
player[1]:set_turn_speed(3)
player[1]:set_max_speed(7)
player[1]:set_player_acc(0.03)
player[1]:set_fuel_dec(0.02)
player[1]:set_extra_power(0)
player[1]:set_extra_recharge(0)
function hook_player_respawn_0(pl)
  pl:set_wall_shield(0)
  pl:set_wall_shield_recharge(0)
  pl:set_shield(2)
  pl:set_max_shield(2)
  pl:set_shield_recharge(0.01)
  pl:set_hull(1)
  pl:set_max_hull(1)
  pl:set_hull_repair(0)
  pl:set_turn_speed(3)
  pl:set_max_speed(7)
  pl:set_player_acc(0.03)
  pl:set_fuel_dec(0.02)
  pl:set_extra_power(0)
  pl:set_extra_recharge(0)
end

local n
for n = 0, player[1]:get_avail_weapon_slots() do
  player[1]:deactivate_weapon_slot(n)
  local waffenschacht   = player[1]:get_weapon_slot(n)
  waffenschacht.type    = 0
  waffenschacht.active  = 0
  waffenschacht.bullets = 0
  waffenschacht.reload  = 0
  player[1]:set_weapon_slot(n, waffenschacht)
end
local waffenschacht   = player[1]:get_weapon_slot(0)
waffenschacht.type    = W_SINGLE
waffenschacht.active  = 1
waffenschacht.bullets = -1
waffenschacht.reload  = -1
player[1]:set_weapon_slot(0, waffenschacht)
local waffenschacht   = player[1]:get_weapon_slot(1)
waffenschacht.type    = W_DOUBLE
waffenschacht.active  = 1
waffenschacht.bullets = 200
waffenschacht.reload  = -1
player[1]:set_weapon_slot(1, waffenschacht)
player[1]:set_active_weapon( 0 )
function hook_enemy_dead_0(en)
  if en:get_type() == E_SHIP_BLUE1 then
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2, -2,  0, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2, -1, -1, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2,  0, -2, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2,  1, -1, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2,  2,  0, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2,  1,  1, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2,  0,  2, 1, 0) 
    effects.bullets:add( W_SINGLE, 0, en:get_nr(), en:get_x()+en:get_width()/2, en:get_y()+en:get_height()/2, -1,  1, 1, 0) 
  end
end

mybase = bases:add( 0, PLAYER_BASE,    91, 107 )

munition_BOMB_bild = images:load("./frapela/w_bomb.bmp")
fuel_bild          = images:load("./frapela/fuel.bmp")
munition_BOMB      = objects:add( 50, munition_BOMB_bild,   2500,  1 )
fuel               = objects:add( 51, fuel_bild,   2500, 25 )
fracht = bases:add( 1, CARGO_BASE,     68, 395 )
fracht:set_cargo_type(CARGO_NORMAL)
fracht:set_cargo_weight(5)
fracht = bases:add( 2, CARGO_BASE,    840, 443 )
fracht:set_cargo_type(CARGO_NORMAL)
fracht:set_cargo_weight(5)
fracht = bases:add( 3, CARGO_BASE,    151, 923 )
fracht:set_cargo_type(CARGO_NORMAL)
fracht:set_cargo_weight(5)
fracht = bases:add( 4, CARGO_BASE,   1125, 828 )
fracht:set_cargo_type(CARGO_NORMAL)
fracht:set_cargo_weight(5)
fracht = bases:add( 5, ENEMY_S_BASE,  511, 253 )
fracht:set_cargo_type(CARGO_OBJECT)
fracht:set_cargo_object(fuel)
fracht:set_cargo_weight(1)
if (LANGUAGE == LANG_DE) then
  fracht:set_cargo_name("Sprit")
else
  fracht:set_cargo_name("Fuel")
end
fracht = bases:add( 6, ENEMY_L_BASE,  815, 832 )
fracht:set_cargo_type(CARGO_OBJECT)
fracht:set_cargo_object(munition_BOMB)
fracht:set_cargo_weight(1)
if (LANGUAGE == LANG_DE) then
  fracht:set_cargo_name("Bomben")
else
  fracht:set_cargo_name("Bombs")
end

dofile("./levels/libcargo.sc")
init_cargo()
function hook_player_returns_cargo_0(pl)
  check_cargo_return(pl)
  if (__cargo_weight > 0) then
    player[1]:set_mission_status(1)
  end
end
function hook_player_dead_0(pl)
  check_cargo_dead(pl)
end

myob = objects:add_special( 0, SPOBJ_TELEPORT1, 363,  50, 1 )
myob = objects:add_special( 1, SPOBJ_TELEPORT1,  75, 219, 1 )

myob = objects:add(  0, OBJ_PILE,  197,  101 )
myob = objects:add(  1, OBJ_PILE,  789,  285 )
myob = objects:add(  2, OBJ_PILE,  211,  385 )
myob = objects:add(  3, OBJ_PILE,  122,  920 )
myob = objects:add(  4, OBJ_PILE,  277,  923 )
myob = objects:add(  5, OBJ_PILE, 1104,  819 )

tuer_1  = objects:add(  5, OBJ_DOORV2,  728, 179 )
tuer_2a = objects:add(  6, OBJ_DOORH2,   86, 708 )
tuer_2b = objects:add(  7, OBJ_DOORH2,  217, 708 )
tuer_3  = objects:add(  8, OBJ_DOORH2, 1082, 684 )
tuer_4  = objects:add(  9, OBJ_DOORH2, 1084, 334 )

myen = enemies:add(  1, E_SHIP_BLUE1,  132,   53, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  840,   47, 1.8, 0 )
myen.wp:add(  132,   53, 1.8, 0 )
myen = enemies:add(  2, E_SHIP_BLUE1, 1050,   50, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  840,   47, 1.3, 0 )
myen.wp:add( 1050,   50, 1.3, 0 )
myen.wp:add( 1050,  157, 0.7, 0 )
myen.wp:add( 1117,  241, 0.7, 0 )
myen.wp:add( 1050,  157, 0.7, 0 )
myen.wp:add( 1050,   50, 0.7, 0 )
myen = enemies:add(  3, E_SHIP_BLUE1, 1105,  577, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add( 1112,  436, 1, 0 )
myen.wp:add( 1105,  577, 1, 0 )
myen.wp:add(  867,  572, 1, 0 )
myen.wp:add( 1105,  577, 1, 0 )
myen = enemies:add(  4, E_SHIP_BLUE1,  859,  719, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  867,  572, 1, 0 )
myen.wp:add(  859,  719, 1, 0 )
myen.wp:add(  700,  592, 1, 0 )
myen.wp:add(  859,  719, 1, 0 )
myen = enemies:add(  5, E_SHIP_BLUE1,   71,  827, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  236,  818, 1, 0 )
myen.wp:add(   71,  827, 1, 0 )
myen = enemies:add(  6, E_SHIP_BLUE1,  259,  351, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  467,  363, 1, 0 )
myen.wp:add(  259,  351, 1, 0 )
myen.wp:add(  280,  487, 1, 0 )
myen.wp:add(  274,  611, 1, 0 )
myen.wp:add(  471,  582, 1, 0 )
myen = enemies:add(  7, E_SHIP_BLUE1,  633,  350, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  614,  204, 1, 0 )
myen.wp:add(  633,  350, 1, 0 )
myen = enemies:add(  8, E_SHIP_BLUE1,  829,  353, 0, 100, 1000, 2, 1, 0 )
myen:set_maxhit( 13 )
myen.wp:add(  826,  206, 1, 0 )
myen.wp:add(  829,  353, 1, 0 )

myen = enemies:add(  9, E_TOWER_SINGLE,  165,  389, 0, D_UP,     40,  400, 5, 1 )
myen = enemies:add( 10, E_TOWER_SINGLE,  294,  230, 0, D_LEFT,   40,  400, 2, 1 )
myen = enemies:add( 11, E_TOWER_SINGLE, 1017,  815, 0, D_LEFT,   40,  400, 2, 1 )
myen = enemies:add( 12, E_TOWER_SINGLE,  344,  907, 0, D_LEFT,   40,  400, 2, 1 )
myen = enemies:add( 13, E_TOWER_SINGLE,   29,  903, 0, D_RIGHT,  40,  400, 2, 1 )
myen = enemies:add( 14, E_TOWER_SINGLE,   28,  579, 0, D_RIGHT,  20, 1000, 2, 1 )
myen = enemies:add( 15, E_TOWER_SINGLE,   30,  595, 0, D_RIGHT,  20, 1000, 2, 1 )
myen = enemies:add( 16, E_TOWER_SINGLE,   29,  611, 0, D_RIGHT,  20, 1000, 2, 1 )
myen = enemies:add( 17, E_TOWER_THREE,   601,  436, 0,          220,  600, 1, 2, 0 )
myen = enemies:add( 18, E_TOWER_THREE,   361,  678, 0,          220,  600, 1, 2, 0 )
myen = enemies:add( 19, E_TOWER_THREE,   685,  681, 0,          220,  600, 1, 2, 0 )
myen = enemies:add( 20, E_TOWER_THREE,   985,  676, 0,          220,  600, 1, 2, 0 )

if (LANGUAGE == LANG_DE) then
  action1 = "[f:impact14][c:white]FRACHT (5)[br][f:impact10][c:orange]RAUM 2 GEOEFFNET!"
  action2 = "[f:impact14][c:white]FRACHT (5)[br][f:impact10][c:orange]RAUM 3 GEOEFFNET!"
  action3 = "[f:impact14][c:white]FRACHT (5)[br][f:impact10][c:orange]RAUM 4 GEOEFFNET!"
  action4 = "[f:impact14][c:white]FRACHT (5)[br][f:impact10][c:orange]AUSGANG OFFEN. FLIEGEN SIE NACH HAUSE!"
elseif (LANGUAGE == LANG_EN) then
  action1 = "[f:impact14][c:white]CARGO (5)[br][f:impact10][c:orange]ROOM 2 UNLOCKED!"
  action2 = "[f:impact14][c:white]CARGO (5)[br][f:impact10][c:orange]ROOM 3 UNLOCKED!"
  action3 = "[f:impact14][c:white]CARGO (5)[br][f:impact10][c:orange]ROOM 4 UNLOCKED!"
  action4 = "[f:impact14][c:white]CARGO (5)[br][f:impact10][c:orange]EXIT UNLOCKED. FLY HOME!"
elseif (LANGUAGE == LANG_CR) then
  action1 = "[f:impact14][c:white]NAKLAD (5)[br][f:impact10][c:orange]MIESTNOST 2 ODOMKNUTA!"
  action2 = "[f:impact14][c:white]NAKLAD (5)[br][f:impact10][c:orange]MIESTNOST 3 ODOMKNUTA!"
  action3 = "[f:impact14][c:white]NAKLAD (5)[br][f:impact10][c:orange]MIESTNOST 4 ODOMKNUTA!"
  action4 = "[f:impact14][c:white]NAKLAD (5)[br][f:impact10][c:orange]VYCHOD ODMKNUTY. LET DOMOV!"
end

function hook_player_takes_cargo_0(pl, ba)
  if     pl:get_land_base() == 1 then
    local frapelaosd = playmap[1].osd:get_osdbit(1000)
    frapelaosd:draw_typewriter_text( action1, 5, 5, 0 )
--  show_player_message( titel,            farbe1,            text,             farbe2,             timeout, screen, rect )
--  show_player_message( "Schrifgröße 14", globals.col_white, "Schrifgröße 10", globals.col_orange,    60*3,      1,    2 )
--  show_player_message( "FRACHT (5)",  globals.col_white, "RAUM 2 GEOEFFNET!", globals.col_orange,    60*3,      1,    2 )
    tuer_1:set_maxframe(0)
    tuer_1:set_startframe(0)
    tuer_1:set_dispframe(0)
  elseif pl:get_land_base() == 2 then
    local frapelaosd = playmap[1].osd:get_osdbit(1000)
    frapelaosd:draw_typewriter_text( action2, 5, 5, 0 )
    tuer_2a:set_maxframe(0)
    tuer_2a:set_startframe(0)
    tuer_2a:set_dispframe(0)
    tuer_2b:set_maxframe(0)
    tuer_2b:set_startframe(0)
    tuer_2b:set_dispframe(0)
  elseif pl:get_land_base() == 3 then
    local frapelaosd = playmap[1].osd:get_osdbit(1000)
    frapelaosd:draw_typewriter_text( action3, 5, 5, 0 )
    tuer_3:set_maxframe(0)
    tuer_3:set_startframe(0)
    tuer_3:set_dispframe(0)
  elseif pl:get_land_base() == 4 then
    local frapelaosd = playmap[1].osd:get_osdbit(1000)
    frapelaosd:draw_typewriter_text( action4, 5, 5, 0 )
    tuer_4:set_maxframe(0)
    tuer_4:set_startframe(0)
    tuer_4:set_dispframe(0)
  elseif pl:get_land_base() == 5 then
    pl:set_fuel( 99 )
    pl:set_weight( pl:get_weight() - 1 )
  elseif pl:get_land_base() == 6 then
    local waffenschacht   = pl:get_weapon_slot( 2 )
    waffenschacht.type    = W_BOMB
    waffenschacht.active  = 1
    waffenschacht.bullets = 20
    waffenschacht.reload  = 60
    pl:set_weapon_slot( 2, waffenschacht )
    pl:set_active_weapon( 2 )
    pl:set_weight( pl:get_weight() - 1 )
  end
end
