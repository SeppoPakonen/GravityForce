-- Mars Mission V
-- Initscript

if (VERSION >= 0.9) then
  dofile("./levels/compat.lua")
end

USER_ENEMY00 = images:load("./bitmap/blueball.bmp")
USER_ENEMY01 = images:load("./bitmap/surprise.bmp")

mybase = bases:add(  0, PLAYER_BASE,  300,  444 )
myob = objects:add(  0, OBJ_PILE,  386,  433 )

globals.score_per_second = 1

start_the_stuff = 0
naechste_welle = 1
gegnerzaehler = 0
sound_time = -1000

if LANGUAGE == LANG_DE then
text1 = "[f:impact14]     Welle 1 von 5"
text2 = "[f:impact14]     Welle 2 von 5"
text3 = "[f:impact14]     Welle 3 von 5"
text4 = "[f:impact14]     Welle 4 von 5"
text5 = "[w:60]Super bisher![w:30] [c:orange]Und um die Spannung noch zu steigern, haben Sie nur noch ein Leben![w:30][br][br][c:yellow]Landen Sie bitte auf der Basis."
else
text1 = "[f:impact14]      Wave 1 of 5"
text2 = "[f:impact14]      Wave 2 of 5"
text3 = "[f:impact14]      Wave 3 of 5"
text4 = "[f:impact14]      Wave 4 of 5"
text5 = "[w:60]Great so long![w:30] [c:orange]And to make things more interesting, you've only got one life by now![w:30][br][br][c:yellow]Please land on your base."
end

function hook_enemy_dead_0(en)
gegnerzaehler = gegnerzaehler + 1
if gegnerzaehler == 6 then
  startzeit = globals.second_time
  naechste_welle = 2
elseif gegnerzaehler == 15 then
  startzeit = globals.second_time
  naechste_welle = 3
elseif gegnerzaehler == 21 then
  startzeit = globals.second_time
  naechste_welle = 4
elseif gegnerzaehler == 25 then
  startzeit = globals.second_time
  naechste_welle = 5
  player[1]:set_lifes(1)
elseif naechste_welle == 7 then
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, -0.3, 0.3, 40 , 0.06 )
  myrocket:set_user(130)
  myrocket:set_ttl(130)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0.3, 0.3, 40 , 0.06 )
  myrocket:set_user(100)
  myrocket:set_ttl(100)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0.3, -0.3, 40 , 0.06 )
  myrocket:set_user(110)
  myrocket:set_ttl(110)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, -0.3, -0.3, 40 , 0.06 )
  myrocket:set_user(120)
  myrocket:set_ttl(120)

  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, -0.4, 0, 40 , 0.06 )
  myrocket:set_user(125)
  myrocket:set_ttl(125)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0.4, 0, 40 , 0.06 )
  myrocket:set_user(105)
  myrocket:set_ttl(105)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, -0.4, 40 , 0.06 )
  myrocket:set_user(115)
  myrocket:set_ttl(115)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0.4, 40 , 0.06 )
  myrocket:set_user(135)
  myrocket:set_ttl(135)

  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0, 40 , 0.03 )
  myrocket:set_user(120)
  myrocket:set_ttl(380)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0, 40 , 0.06 )
  myrocket:set_user(260)
  myrocket:set_ttl(480)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0, 40 , 0.08 )
  myrocket:set_user(380)
  myrocket:set_ttl(560)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0, 40 , 0.1 )
  myrocket:set_user(480)
  myrocket:set_ttl(625)
  myrocket = effects.bullets:add( W_ROCKET, 0, 0, 342,  187, 0, 0, 40 , 0.12 )
  myrocket:set_user(550)
  myrocket:set_ttl(660)
  naechste_welle = 8
  startzeit = globals.second_time
  sound_time = globals.game_time
end
if en:get_nr() == 400 then
  firstexpl = effects.explosions:add(EXP_BIG_2, 3, 3, en:get_x() - 20, en:get_y() - 28)
  gsound:play_sound(SOUND_EXPL_BIG1, en:get_x(), en:get_y(), 100)
  gsound:play_sound(SOUND_EXPL_BIG1, en:get_x(), en:get_y(), 50)
end
end

-- Es besteht kein Grund, die Raketen zu verlangsamen,
-- man koennte sie sogar noch schneller machen und der
-- Level waere immer noch zu schaffen. :-)