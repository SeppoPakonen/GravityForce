-- Frapela5a
-- INI file
-- created by GS-Map-Editor v0.6
-- und Frapela
-- 30.11.2002

---------------------------------------------------------------------------------------------------
-- PLATZHALTER -- PLATZHALTER -- PLATZHALTER -- PLATZHALTER -- PLATZHALTER -- PLATZHALTER ---------
---------------------------------------------------------------------------------------------------


if (VERSION >= 0.9) then
  dofile("./levels/compat.lua")
end

Fracht = {}
leben = 0

---------------------------------------------------------------------------------------------------
-- OBJEKTE -- OBJEKTE -- OBJEKTE -- OBJEKTE -- OBJEKTE -- OBJEKTE --  OBJEKTE  --  OBJEKTE  -------
---------------------------------------------------------------------------------------------------

-- Basen
Heimatbasis = bases:add(  0, PLAYER_BASE,  558,  635 )
Fracht[1] = bases:add(  1, CARGO_BASE, 2290, 1114 )
Fracht[2] = bases:add(  2, CARGO_BASE,  842, 1161 )
Fracht[3] = bases:add(  3, CARGO_BASE, 1660, 1595 )
Fracht[4] = bases:add(  4, CARGO_BASE,  703, 2363 )
Fracht[5] = bases:add(  5, CARGO_BASE, 2122, 2364 )
local i
for i = 1, 5 do
  Fracht[i]:set_cargo_type(CARGO_NORMAL)
  Fracht[i]:set_cargo_weight(21)
end

-- Respawning Extras
dofile("./levels/libextra.sc")
add_respawning_extra(  986, 1136, 30,   60)

-- SPOBJ_TELEPORT1, Parameter:                            zielteleporter
myob = objects:add_special(  0, SPOBJ_TELEPORT1, 2364,  794,             1 )
myob = objects:add_special(  1, SPOBJ_TELEPORT1, 1013, 1174,             0 )
myob = objects:add_special(  2, SPOBJ_TELEPORT1, 1611, 1554,             3 )
myob = objects:add_special(  3, SPOBJ_TELEPORT1, 2257,  571,             2 )

-- Tür und Schalter
tuer1 = objects:add(  1, OBJ_DOORV2, 2145,  521 )
tuer2 = objects:add(  2, OBJ_DOORH2,  744,  843 )
tuer2:set_maxframe(0)   
tuer2:set_startframe(0) 
tuer2:set_dispframe(0)
schalter0 = objects:add(  0, OBJ_SWITCHR, 1579,  955 )
schalter  = objects:get_object(0)
letzter_zustand = schalter:get_dispframe()

---------------------------------------------------------------------------------------------------
-- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER -- GEGNER 
---------------------------------------------------------------------------------------------------

-- E_SHIP_BLUE2, Parameter:                        signatur, feuerfrequenz, akt.radius, schussgeschwindigkeit, schussstaerke, [unbenutzt]
myen = enemies:add(  1, E_SHIP_BLUE2, 2212,  801,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 2212,  801, 1.0, 0 )
myen.wp:add( 2265,  862, 1.0, 0 )
myen.wp:add( 2265, 1045, 1.0, 0 )
myen = enemies:add(  2, E_SHIP_BLUE2, 1932,  777,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1932,  777, 1.0, 0 )
myen.wp:add( 1689,  777, 1.0, 0 )
myen.wp:add( 1932,  533, 1.0, 0 )
myen = enemies:add(  3, E_SHIP_BLUE2, 1007,  531,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1007,  531, 1.0, 0 )
myen.wp:add( 1007,  629, 1.0, 0 )
myen.wp:add( 1120,  531, 1.0, 0 )
myen.wp:add( 1210,  776, 1.0, 0 )
myen = enemies:add(  4, E_SHIP_BLUE2,  533, 1160,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add(  533, 1160, 1.0, 0 )
myen.wp:add(  738, 1308, 1.0, 0 )
myen.wp:add(  531, 1404, 1.0, 0 )
myen.wp:add(  729, 1404, 1.0, 0 )
myen = enemies:add(  5, E_SHIP_BLUE2, 1149, 1398,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1149, 1398, 1.0, 0 )
myen.wp:add( 1397, 1446, 1.0, 0 )
myen.wp:add( 1397, 1640, 1.0, 0 )
myen = enemies:add(  9, E_SHIP_BLUE2, 1160, 1973,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1160, 1973, 1.0, 0 )
myen.wp:add(  890, 2313, 1.0, 0 )
myen = enemies:add( 10, E_SHIP_BLUE2, 1344, 1973,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1344, 1973, 1.0, 0 )
myen.wp:add( 1074, 2313, 1.0, 0 )
myen = enemies:add( 11, E_SHIP_BLUE2, 1970, 1977,         0,            50,       1200,                     3,             2,           0 )
myen.wp:add( 1970, 1977, 1.0, 0 )
myen.wp:add( 2272, 2073, 1.0, 0 )

-- E_SHIP_BIGRED, Parameter:                       signatur, [unbenutzt], [unbenutzt], [unbenutzt], [unbenutzt], [unbenutzt]
myen = enemies:add(  6, E_SHIP_BIGRED, 1879, 1541,        0,           0,           0,           0,           0,           0 )
myen.wp:add( 1879, 1541, 1.0, 0 )
myen.wp:add( 2020, 1304, 1.0, 0 )
myen.wp:add( 2292, 1304, 1.0, 0 )
myen = enemies:add(  7, E_SHIP_BIGRED, 1637,  964,        0,           0,           0,           0,           0,           0 )
myen.wp:add( 1637,  964, 1.0, 0 )
myen.wp:add( 1951, 1113, 1.0, 0 )
myen = enemies:add(  8, E_SHIP_BIGRED, 1262, 1976,        0,           0,           0,           0,           0,           0 )
myen.wp:add( 1262, 1976, 1.0, 0 )
myen.wp:add(  992, 2316, 1.0, 0 )
myen = enemies:add( 12, E_SHIP_BIGRED,  709, 1792,        0,           0,           0,           0,           0,           0 )
myen.wp:add(  709, 1792, 1.0, 0 )
myen.wp:add(  531, 1900, 1.0, 0 )
myen.wp:add(  700, 2014, 1.0, 0 )
myen.wp:add(  530, 2014, 1.0, 0 )
myen.wp:add(  702, 1900, 1.0, 0 )
myen.wp:add(  531, 1678, 1.0, 0 )
myen = enemies:add( 24, E_SHIP_BIGRED, 2168,  530,        0,           0,           0,           0,           0,           0 )
myen.wp:add( 2168,  530, 1.0, 0 )
myen.wp:add( 2168,  587, 1.0, 0 )

-- E_TOWER_SINGLE, Parameter:                       signatur, richtung, feuerfrequenz, akt.radius, schussgeschwindigkeit, schussstaerke
myen = enemies:add( 13, E_TOWER_SINGLE,  730,  797,        0,     D_UP,            30,       1200,                     2,             1 )
myen = enemies:add( 14, E_TOWER_SINGLE,  686,  747,        0,     D_UP,            40,       1200,                     3,             1 )
myen = enemies:add( 15, E_TOWER_SINGLE,  855,  819,        0,   D_LEFT,            50,       1200,                     4,             1 )
myen = enemies:add( 16, E_TOWER_SINGLE,  480,  868,        0,  D_RIGHT,            60,       1200,                     5,             1 )
myen = enemies:add( 17, E_TOWER_SINGLE,  518,  959,        0,  D_RIGHT,            50,       1200,                     4,             1 )
myen = enemies:add( 18, E_TOWER_SINGLE,  518, 1540,        0,  D_RIGHT,            40,       1200,                     3,             1 )
myen = enemies:add( 19, E_TOWER_SINGLE,  519, 2116,        0,  D_RIGHT,            30,       1200,                     2,             1 )
myen = enemies:add( 23, E_TOWER_SINGLE, 2136,  688,        0,   D_LEFT,            40,       2000,                     4,             1 )
myen = enemies:add( 28, E_TOWER_SINGLE, 2080, 1106,        0,     D_UP,            50,       1200,                     4,             1 )
myen = enemies:add( 29, E_TOWER_SINGLE, 2166, 1111,        0,     D_UP,            60,       1200,                     5,             1 )
myen = enemies:add( 31, E_TOWER_SINGLE, 1815, 1630,        0,  D_RIGHT,            50,       1200,                     4,             1 )
myen = enemies:add( 32, E_TOWER_SINGLE, 2357, 1599,        0,   D_LEFT,            40,       1200,                     3,             1 )
myen = enemies:add( 33, E_TOWER_SINGLE, 2358, 1679,        0,   D_LEFT,            30,       1200,                     2,             1 )

-- E_TOWER_THREE, Parameter:                        signatur, feuerfrequenz, akt.radius, schussgeschwindigkeit, schussstaerke, [unbenutzt]
myen = enemies:add( 20, E_TOWER_THREE,  820, 1159,         0,            50,       1000,                     2,             1,           0 )
myen = enemies:add( 25, E_TOWER_THREE, 2043, 1108,         0,            30,       1000,                     3,             1,           0 )
myen = enemies:add( 27, E_TOWER_THREE, 2192, 1114,         0,            40,       1000,                     3,             1,           0 )
myen = enemies:add( 46, E_TOWER_THREE, 1326,  775,         0,            30,       1000,                     2,             1,           0 )
myen = enemies:add( 47, E_TOWER_THREE, 1643,  777,         0,            20,       1000,                     2,             1,           0 )

-- E_TOWER_FLAK, Parameter:                       signatur, expl.zeit, feuerfrequenz, akt.radius, schussgeschwindigkeit, schussstaerke
-- myen = enemies:add( 21, E_TOWER_FLAK, 1160, 1296,        0,        80,            60,       1200,                     6,             3 )
myen = enemies:add( 21, E_TOWER_FLAK, 1155, 1296,        0,        80,            60,       1200,                     6,             3 )
myen = enemies:add( 21, E_TOWER_FLAK, 1168, 1297,        0,        50,            60,       1200,                     2,             3 )

myen = enemies:add( 22, E_TOWER_FLAK, 2103,  716,        0,        80,            57,       1200,                     3,             3 )
myen = enemies:add( 26, E_TOWER_FLAK, 2120, 1108,        0,        80,            60,       1200,                     3,             3 )
myen = enemies:add( 30, E_TOWER_FLAK, 1835, 1536,        0,        80,            60,       1200,                     4,             3 )
myen = enemies:add( 45, E_TOWER_FLAK, 1792, 1433,        0,        80,            60,       1200,                     3,             3 )

-- E_TANK_FLYINGTOWER, Parameter:                       signatur,      turm-ladung, feuerfrequenz, akt.radius, schussgeschwindigkeit, schussstaerke
myen = enemies:add( 34, E_TANK_FLYINGTOWER, 2332, 2350,        0,    E_TOWER_PULSE,            40,       1000,                     3,             1 )
myen.wp:add( 2332, 2350, 1.0, 0 )
myen.wp:add( 2278, 2350, 1.0, 0 )
myen.wp:add( 2243, 2360, 1.0, 0 )
myen.wp:add( 2208, 2346, 1.0, 0 )
myen.wp:add( 2259, 2357, 1.0, 0 )
myen.wp:add( 2284, 2349, 1.0, 0 )
myen = enemies:add( 35, E_TANK_FLYINGTOWER, 2089, 2350,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add( 2089, 2350, 1.0, 0 )
myen.wp:add( 1949, 2350, 1.0, 0 )
myen = enemies:add( 36, E_TANK_FLYINGTOWER, 1925, 2350,        0,    E_TOWER_THREE,            50,       1000,                     2,             1 )
myen.wp:add( 1925, 2350, 1.0, 0 )
myen.wp:add( 1785, 2350, 1.0, 0 )
myen = enemies:add( 37, E_TANK_FLYINGTOWER, 1761, 2350,        0,    E_TOWER_THREE,            50,       1000,                     2,             1 )
myen.wp:add( 1761, 2350, 1.0, 0 )
myen.wp:add( 1621, 2350, 1.0, 0 )
myen = enemies:add( 38, E_TANK_FLYINGTOWER, 1597, 2357,        0,   E_TOWER_SINGLE,            10,       1200,                     1,             1 )
myen.wp:add( 1597, 2357, 1.0, 0 )
myen.wp:add( 1559, 2357, 1.0, 0 )
myen.wp:add( 1546, 2350, 1.0, 0 )
myen.wp:add( 1426, 2350, 1.0, 0 )
myen = enemies:add( 39, E_TANK_FLYINGTOWER,  782, 2350,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add(  782, 2350, 1.0, 0 )
myen.wp:add(  867, 2350, 1.0, 0 )
myen = enemies:add( 40, E_TANK_FLYINGTOWER,  538, 2350,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add(  538, 2350, 1.0, 0 )
myen.wp:add(  671, 2350, 1.0, 0 )
myen = enemies:add( 41, E_TANK_FLYINGTOWER, 1108, 1771,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add( 1108, 1771, 1.0, 0 )
myen.wp:add( 1077, 1777, 1.0, 0 )
myen.wp:add( 1053, 1771, 1.0, 0 )
myen.wp:add(  907, 1776, 1.0, 0 )
myen.wp:add(  851, 1772, 1.0, 0 )
myen.wp:add(  798, 1781, 1.0, 0 )
myen.wp:add(  851, 1772, 1.0, 0 )
myen.wp:add(  902, 1775, 1.0, 0 )
myen.wp:add( 1053, 1774, 1.0, 0 )
myen.wp:add( 1078, 1778, 1.0, 0 )
myen = enemies:add( 42, E_TANK_FLYINGTOWER, 1928, 1960,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add( 1928, 1960, 1.0, 0 )
myen.wp:add( 1701, 1960, 1.0, 0 )
myen = enemies:add( 43, E_TANK_FLYINGTOWER, 1454, 1960,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add( 1454, 1960, 1.0, 0 )
myen.wp:add( 1681, 1960, 1.0, 0 )
myen = enemies:add( 44, E_TANK_FLYINGTOWER, 1504, 1429,        0,    E_TOWER_PULSE,            20,       1000,                     3,             1 )
myen.wp:add( 1504, 1429, 1.0, 0 )
myen.wp:add( 1748, 1431, 1.0, 0 )
myen = enemies:add( 48, E_TANK_FLYINGTOWER, 1380,  765,        0,    E_TOWER_THREE,            50,       1000,                     2,             1 )
myen.wp:add( 1380,  765, 1.0, 0 )
myen.wp:add( 1582,  765, 1.0, 0 )
myen = enemies:add( 49, E_TANK_FLYINGTOWER, 1103, 1043,        0,    E_TOWER_THREE,            50,       1000,                     2,             1 )
myen.wp:add( 1103, 1043, 1.0, 0 )
myen.wp:add(  937, 1044, 1.0, 0 )

---------------------------------------------------------------------------------------------------
-- FUNKTIONEN -- FUNKTIONEN -- FUNKTIONEN -- FUNKTIONEN -- FUNKTIONEN -- FUNKTIONEN -- FUNKTIONEN -
---------------------------------------------------------------------------------------------------

globals.score_per_second = 1

-- Schalter und Türen wieder in Ausgangsposition
function hook_player_dead_0(pl)
  tuer1:set_maxframe(3)   
  tuer1:set_startframe(1) 
  tuer1:set_dispframe(1) 
  tuer2:set_maxframe(0)   
  tuer2:set_startframe(0) 
  tuer2:set_dispframe(0)
  schalter:set_dispframe(0)
  letzter_zustand = schalter:get_dispframe()
end

-- tote Gegner zählen 
function hook_enemy_dead_0(en)
  leben = leben + 1
  if leben == 1 then
    local paketosd = playmap[1].osd:get_osdbit(1000)
    if (LANGUAGE == LANG_DE) then
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Dieses war der erste Streich!", 30, 4, 1)
    else 
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]The first one!", 30, 4, 1)
    end
  elseif leben == 32 then
    local paketosd = playmap[1].osd:get_osdbit(1000)
    if (LANGUAGE == LANG_DE) then
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Bergfest!", 30, 4, 1)
    else 
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]fifty - fifty!", 30, 4, 1)
    end
  elseif leben == 53 then
    if (LANGUAGE == LANG_DE) then
    local paketosd = playmap[1].osd:get_osdbit(1000)
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Zehn kleine Gegnerlein - die muessen noch vom Feld - wenn keiner dann mehr uebrig ist - dann bist du hier der Held!", 30, 4, 1)
    else 
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Only ten enemies, go on!", 30, 4, 1)
    end
  elseif leben == 63 then
    local paketosd = playmap[1].osd:get_osdbit(1000)
    if (LANGUAGE == LANG_DE) then
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Fantastisch " .. player[1]:get_name() .. ",  aber das Hauptquartier hat schlechte Neuigkeiten. Lande sofort auf der Frachtbasis im Sued-osten, um dich dort mit einem unserer Spione zu treffen!", 10, 4, 1)
    else 
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]Fabulous " .. player[1]:get_name() .. ", but the headquarter has bad news. Fly to the southern east cargo-base to meet our spy!", 10, 4, 1)
    end
  else
    local paketosd = playmap[1].osd:get_osdbit(1000)
    if (LANGUAGE == LANG_DE) then
      paketosd:draw_typewriter_text("[center][f:impact10][c:orange]" .. 63-leben, 30, 4, 0)
    else 
      paketosd:draw_typewriter_text("[center][f:impact10][c:yellow]" .. 63-leben, 30, 4, 0)
    end
  end
end

function hook_player_land_0(pl, ba)
  if player[1]:get_land_base() == 5 then
    if leben == 63 then
      player[1]:set_mission_status(1)
    end
  end
end