-- DONUT
-- init script

bases:add( 0, CARGO_BASE,   765,   346 )
bases:add( 1, CARGO_BASE,   765,   1500 )

objects:add( 0, OBJ_PILE,   840,  340 )
objects:add( 1, OBJ_PILE,   840,  1492 )

objects:add( 2, OBJ_SWITCHL, 1545,  760 )

swcount = 0
switch = objects:get_object(2)

function hook_object_hit_1(ob)
if (ob:get_type() == OBJ_SWITCHL and ob:get_nr() == 2) then
    active = switch:get_dispframe()
  if (active == 0 and swcount == 0) then
      swcount = 90*50
      plshot_sig = ob:get_hitby()
      plshot = get_player_nr_by_sig(plshot_sig) + 1
      if plshot == 2 then
      objects:add_special( 3, SPOBJ_EXTRA, player[1]:get_x(), player[1]:get_y(), 5 )
      end
      if plshot == 1 then
      objects:add_special( 4, SPOBJ_EXTRA, player[2]:get_x(), player[2]:get_y(), 5 )
      end
      effects.bullets:add( W_ROCKET, plshot_sig, 0, 785, 150, 0.5, 0.5, 20, 20, 20, 0.1 )
      effects.bullets:add( W_ROCKET, plshot_sig, 0, 785, 1280, 0.5, 0.5, 20, 20, 20, 0.1 )
      effects.bullets:add( W_ROCKET, plshot_sig, 0, 1390, 760, 0.5, 0.5, 20, 20, 20, 0.1 )
      effects.bullets:add( W_ROCKET, plshot_sig, 0, 230, 760, 0.5, 0.5, 20, 20, 20, 0.1 )
      else
      switch:set_dispframe(0)
end
end
end

function check_switch()
    if swcount > 0 then
      swcount = swcount - 1
    if swcount == 0 then
      switch:set_dispframe(0)
end
end
end
