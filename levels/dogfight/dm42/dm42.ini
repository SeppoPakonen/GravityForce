-- deatchmatch 42
-- init script

dofile("./levels/libeff.sc")

bases:add(  0, PLAYER_BASE,  140, 1404 )
bases:add(  1, PLAYER_BASE,  175,  395 )
bases:add(  2, PLAYER_BASE, 1430, 1787 )
bases:add(  3, PLAYER_BASE, 1517,  540 )


-- Teleporter setzen

function hook_player_with_spobject_0(pl, ob)
  if (ob:get_type() == SPOBJ_TELEPORT1 and ob:get_nr() == 11) then
    ob:set_user( math.random(3)+11 )
  end
end

objects:add_special( 11, SPOBJ_TELEPORT1,  1930,  790,  12 )
objects:add_special( 12, SPOBJ_TELEPORT1,  1985,  2366,  11 )
objects:add_special( 13, SPOBJ_TELEPORT1,  2145,  2422,  11 )
objects:add_special( 14, SPOBJ_TELEPORT1,  2325, 2376, 11 )

-- Gummiw„nde setzen / unten

objects:add_special( 20, SPOBJ_BUMPU,   1667,  1105 )
objects:add_special( 21, SPOBJ_BUMPU,   1747,  1105 )
objects:add_special( 22, SPOBJ_BUMPU,   1827,  1105 )
objects:add_special( 23, SPOBJ_BUMPU,   1907,  1105 )
objects:add_special( 24, SPOBJ_BUMPU,   1987,  1105 )
objects:add_special( 25, SPOBJ_BUMPU,   2067,  1105 )
objects:add_special( 25, SPOBJ_BUMPU,   2147,  1105 )
objects:add_special( 26, SPOBJ_BUMPU,   2227,  1105 )

-- Gummiw„nde setzen / rechts

objects:add_special( 27, SPOBJ_BUMPR,   2302,  1025 )
objects:add_special( 28, SPOBJ_BUMPR,   2302,  945 )
objects:add_special( 29, SPOBJ_BUMPR,   2302,  865 )
objects:add_special( 30, SPOBJ_BUMPR,   2302,  785 )
objects:add_special( 31, SPOBJ_BUMPR,   2302,  705 )
objects:add_special( 32, SPOBJ_BUMPR,   2302,  625 )

-- Gummiw„nde setzen / links

objects:add_special( 33, SPOBJ_BUMPL,   1667,  1025 )
objects:add_special( 34, SPOBJ_BUMPL,   1667,  945 )
objects:add_special( 38, SPOBJ_BUMPL,   1667,  628 )

-- Gummiw„nde setzen / oben

objects:add_special( 39, SPOBJ_BUMPD,   1670,  628 )
objects:add_special( 40, SPOBJ_BUMPL,   1750,  555 )
objects:add_special( 41, SPOBJ_BUMPD,   1750,  550 )
objects:add_special( 42, SPOBJ_BUMPL,   1830,  475 )
objects:add_special( 43, SPOBJ_BUMPD,   1830,  470 )
objects:add_special( 44, SPOBJ_BUMPL,   1910,  395 )
objects:add_special( 45, SPOBJ_BUMPD,   1910,  390 )
objects:add_special( 45, SPOBJ_BUMPD,   1990,  390 )
objects:add_special( 46, SPOBJ_BUMPR,   2070,  392 )
objects:add_special( 47, SPOBJ_BUMPD,   2070,  470 )
objects:add_special( 48, SPOBJ_BUMPR,   2143,  475 )
objects:add_special( 49, SPOBJ_BUMPD,   2145,  550 )
objects:add_special( 50, SPOBJ_BUMPR,   2220,  550 )
objects:add_special( 51, SPOBJ_BUMPD,   2225,  625 )

-- extras setzen
-- (ez=nummer;es=staeke;ey=y-koordinate;ex=x-koo.;en=objektnummer;et=zeit zum reload)

objects:add_special( 15, SPOBJ_EXTRA,   1520, 520, 5 )
objects:add_special( 16, SPOBJ_EXTRA,   1500, 1650, 5 )
objects:add_special( 17, SPOBJ_EXTRA,   2148, 2340, 30 )

check_extra_counter = {}
check_extra_counter[ 15 ] = 0
check_extra_counter[ 16 ] = 0
check_extra_counter[ 17 ] = 0

function check_extra(ez,es,ex,ey,en,et)
   local en = objects:get_spobject(ez)

   if (en == nil) then
     check_extra_counter[ez] = check_extra_counter[ez] + 1

     if (check_extra_counter[ez] >= 60*et) then
       objects:add_special( ez, SPOBJ_EXTRA, ex, ey, es )
       check_extra_counter[ez] = 0
     end
   end
end

